function [A] = AreaTriVoronoi(XYmat,in,varargin)
if in
    if nargin <3
        A = SharpeTrig(XYmat);
    else
        A = SharpeTrig(XYmat,varargin);
    end
else
    angles = findAngles(XYmat);
    if nargin <3
        A = ObtuseTrig(XYmat,angles);
    else
        A = ObtuseTrig(XYmat,angles,varargin);
    end
end
end

function [angles] = findAngles(M)
x1=M(1); y1=M(2); x2=M(3); y2=M(4); x3=M(5); y3=M(6);
aCalc  = @(Li,Lj,Lk) acos((Li^2+Lj^2-Lk^2)/(2*Li*Lj));
L1 = lCalc(x1,y1,x2,y2);
L2 = lCalc(x2,y2,x3,y3);
L3 = lCalc(x3,y3,x1,y1);
A13 = aCalc(L1,L3,L2); A12 = aCalc(L1,L2,L3);
angles = [A13,A12,pi-A13-A12];
end

function [l] = lCalc(xi,yi,xj,yj)
l = ((xi-xj)^2+(yi-yj)^2)^0.5;
end

function [out] = SharpeTrig(M,varargin)
x1=M(1); y1=M(2); x2=M(3); y2=M(4); x3=M(5); y3=M(6);
if nargin <2
  out=[ (((x1-x2).*((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2)-(x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2)+2.*y1.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8-((x1-x3).*((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2)-(x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2)+2.*y3.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8-((y1-y2).*((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2)-(y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2)+2.*x1.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8+((y1-y3).*((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2)-(y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2)+2.*x3.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8)./((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2));
        (((x1-x2).*((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2)-(x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2)+2.*y1.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8+((x2-x3).*((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2)-(x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2)+2.*y2.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8-((y1-y2).*((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2)-(y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2)+2.*x1.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8-((y2-y3).*((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2)-(y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2)+2.*x2.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8)./((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2));
       -(((x1-x3).*((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2)-(x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2)+2.*y3.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8-((x2-x3).*((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2)-(x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2)+2.*y2.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8-((y1-y3).*((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2)-(y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2)+2.*x3.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8+((y2-y3).*((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2)-(y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2)+2.*x2.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8)./((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))];
else 
   out=[(((y1-y3).*(2.*x1.*(y1-y2)-2.*x1.*(y1-y3)+2.*x3.*(y2-y3)))./8+((x1-x2).*(2.*x1.*(x1-x3)-2.*x1.*(x1-x2)+2.*y1.*(y2-y3)-x2.^2+x3.^2-y2.^2+y3.^2))./8-((x1-x3).*(2.*x1.*(x1-x3)-2.*x1.*(x1-x2)+2.*y3.*(y2-y3)-x2.^2+x3.^2-y2.^2+y3.^2))./8-((y1-y2).*(2.*x1.*(y1-y2)-2.*x1.*(y1-y3)+2.*x1.*(y2-y3)+2.*(x1-x2).*(y1-y3)-2.*(x1-x3).*(y1-y2)))./8+(y1.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)))./4-(y3.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)))./4)./((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))-((y2-y3).*(((x1-x2).*((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2)-(x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2)+2.*y1.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8-((x1-x3).*((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2)-(x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2)+2.*y3.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8-((y1-y2).*((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2)-(y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2)+2.*x1.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8+((y1-y3).*((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2)-(y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2)+2.*x3.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8))./((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)).^2,(((x1-x3).*(2.*y1.*(x1-x2)-2.*y1.*(x1-x3)+2.*y3.*(x2-x3)))./8+((y1-y2).*(2.*x1.*(x2-x3)-2.*y1.*(y1-y2)+2.*y1.*(y1-y3)-x2.^2+x3.^2-y2.^2+y3.^2))./8-((y1-y3).*(2.*x3.*(x2-x3)-2.*y1.*(y1-y2)+2.*y1.*(y1-y3)-x2.^2+x3.^2-y2.^2+y3.^2))./8-((x1-x2).*(2.*y1.*(x1-x2)-2.*y1.*(x1-x3)+2.*y1.*(x2-x3)-2.*(x1-x2).*(y1-y3)+2.*(x1-x3).*(y1-y2)))./8-(x1.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)))./4+(x3.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)))./4)./((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))+((x2-x3).*(((x1-x2).*((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2)-(x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2)+2.*y1.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8-((x1-x3).*((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2)-(x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2)+2.*y3.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8-((y1-y2).*((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2)-(y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2)+2.*x1.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8+((y1-y3).*((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2)-(y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2)+2.*x3.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8))./((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)).^2,(((2.*x1.*(y1-y3)-2.*x2.*(y1-y3)).*(y1-y2))./8+((2.*x2.*(y1-y3)-2.*x3.*(y1-y3)).*(y1-y3))./8-((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2))./8+((x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2))./8-((x1-x2).*(2.*x2.*(x1-x3)+2.*y1.*(y1-y3)-x1.^2+x3.^2-y1.^2+y3.^2))./8+((x1-x3).*(2.*x2.*(x1-x3)+2.*y3.*(y1-y3)-x1.^2+x3.^2-y1.^2+y3.^2))./8-(y1.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)))./4)./((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))+((y1-y3).*(((x1-x2).*((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2)-(x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2)+2.*y1.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8-((x1-x3).*((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2)-(x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2)+2.*y3.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8-((y1-y2).*((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2)-(y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2)+2.*x1.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8+((y1-y3).*((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2)-(y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2)+2.*x3.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8))./((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)).^2,(((2.*y1.*(x1-x3)-2.*y2.*(x1-x3)).*(x1-x2))./8+((2.*y2.*(x1-x3)-2.*y3.*(x1-x3)).*(x1-x3))./8-((y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2))./8+((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2))./8-((y1-y2).*(2.*x1.*(x1-x3)+2.*y2.*(y1-y3)-x1.^2+x3.^2-y1.^2+y3.^2))./8+((y1-y3).*(2.*x3.*(x1-x3)+2.*y2.*(y1-y3)-x1.^2+x3.^2-y1.^2+y3.^2))./8+(x1.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)))./4)./((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))-((x1-x3).*(((x1-x2).*((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2)-(x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2)+2.*y1.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8-((x1-x3).*((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2)-(x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2)+2.*y3.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8-((y1-y2).*((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2)-(y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2)+2.*x1.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8+((y1-y3).*((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2)-(y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2)+2.*x3.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8))./((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)).^2,(((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2))./8-((2.*x1.*(y1-y2)-2.*x3.*(y1-y2)).*(y1-y2))./8-((x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2))./8+((x1-x2).*(2.*x3.*(x1-x2)+2.*y1.*(y1-y2)-x1.^2+x2.^2-y1.^2+y2.^2))./8-((x1-x3).*(2.*x3.*(x1-x2)+2.*y3.*(y1-y2)-x1.^2+x2.^2-y1.^2+y2.^2))./8+(y3.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)))./4+((y1-y3).*(2.*(x1-x2).*(y1-y3)-2.*(x1-x3).*(y1-y2)))./8)./((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))-((y1-y2).*(((x1-x2).*((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2)-(x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2)+2.*y1.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8-((x1-x3).*((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2)-(x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2)+2.*y3.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8-((y1-y2).*((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2)-(y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2)+2.*x1.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8+((y1-y3).*((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2)-(y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2)+2.*x3.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8))./((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)).^2,((x1-x2).*(((x1-x2).*((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2)-(x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2)+2.*y1.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8-((x1-x3).*((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2)-(x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2)+2.*y3.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8-((y1-y2).*((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2)-(y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2)+2.*x1.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8+((y1-y3).*((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2)-(y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2)+2.*x3.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8))./((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)).^2-(((2.*y1.*(x1-x2)-2.*y3.*(x1-x2)).*(x1-x2))./8-((y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2))./8+((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2))./8-((y1-y2).*(2.*x1.*(x1-x2)+2.*y3.*(y1-y2)-x1.^2+x2.^2-y1.^2+y2.^2))./8+((y1-y3).*(2.*x3.*(x1-x2)+2.*y3.*(y1-y2)-x1.^2+x2.^2-y1.^2+y2.^2))./8+(x3.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)))./4+((x1-x3).*(2.*(x1-x2).*(y1-y3)-2.*(x1-x3).*(y1-y2)))./8)./((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2));
        (((x1-x2).*(2.*x1.*(x1-x3)-2.*x1.*(x1-x2)+2.*y1.*(y2-y3)-x2.^2+x3.^2-y2.^2+y3.^2))./8-((y2-y3).*(2.*x1.*(y1-y2)-2.*x1.*(y1-y3)+2.*x2.*(y2-y3)))./8+((x2-x3).*(2.*x1.*(x1-x3)-2.*x1.*(x1-x2)+2.*y2.*(y2-y3)-x2.^2+x3.^2-y2.^2+y3.^2))./8-((y1-y2).*(2.*x1.*(y1-y2)-2.*x1.*(y1-y3)+2.*x1.*(y2-y3)+2.*(x1-x2).*(y1-y3)-2.*(x1-x3).*(y1-y2)))./8+((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2))./8-((x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2))./8+(y1.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)))./4)./((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))-((y2-y3).*(((x1-x2).*((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2)-(x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2)+2.*y1.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8+((x2-x3).*((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2)-(x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2)+2.*y2.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8-((y1-y2).*((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2)-(y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2)+2.*x1.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8-((y2-y3).*((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2)-(y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2)+2.*x2.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8))./((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)).^2,((x2-x3).*(((x1-x2).*((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2)-(x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2)+2.*y1.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8+((x2-x3).*((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2)-(x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2)+2.*y2.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8-((y1-y2).*((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2)-(y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2)+2.*x1.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8-((y2-y3).*((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2)-(y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2)+2.*x2.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8))./((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)).^2-(((x2-x3).*(2.*y1.*(x1-x2)-2.*y1.*(x1-x3)+2.*y2.*(x2-x3)))./8-((y1-y2).*(2.*x1.*(x2-x3)-2.*y1.*(y1-y2)+2.*y1.*(y1-y3)-x2.^2+x3.^2-y2.^2+y3.^2))./8-((y2-y3).*(2.*x2.*(x2-x3)-2.*y1.*(y1-y2)+2.*y1.*(y1-y3)-x2.^2+x3.^2-y2.^2+y3.^2))./8+((x1-x2).*(2.*y1.*(x1-x2)-2.*y1.*(x1-x3)+2.*y1.*(x2-x3)-2.*(x1-x2).*(y1-y3)+2.*(x1-x3).*(y1-y2)))./8-((y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2))./8+((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2))./8+(x1.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)))./4)./((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)),((y1-y3).*(((x1-x2).*((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2)-(x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2)+2.*y1.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8+((x2-x3).*((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2)-(x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2)+2.*y2.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8-((y1-y2).*((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2)-(y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2)+2.*x1.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8-((y2-y3).*((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2)-(y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2)+2.*x2.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8))./((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)).^2-(((x1-x2).*(2.*x2.*(x1-x3)+2.*y1.*(y1-y3)-x1.^2+x3.^2-y1.^2+y3.^2))./8-((2.*x1.*(y1-y3)-2.*x2.*(y1-y3)).*(y1-y2))./8+((x2-x3).*(2.*x2.*(x1-x3)+2.*y2.*(y1-y3)-x1.^2+x3.^2-y1.^2+y3.^2))./8+(y1.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)))./4-(y2.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)))./4+((y2-y3).*(2.*(x1-x2).*(y1-y3)-2.*(x1-x3).*(y1-y2)))./8)./((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)),(((2.*y1.*(x1-x3)-2.*y2.*(x1-x3)).*(x1-x2))./8-((y1-y2).*(2.*x1.*(x1-x3)+2.*y2.*(y1-y3)-x1.^2+x3.^2-y1.^2+y3.^2))./8-((y2-y3).*(2.*x2.*(x1-x3)+2.*y2.*(y1-y3)-x1.^2+x3.^2-y1.^2+y3.^2))./8+(x1.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)))./4-(x2.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)))./4+((x2-x3).*(2.*(x1-x2).*(y1-y3)-2.*(x1-x3).*(y1-y2)))./8)./((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))-((x1-x3).*(((x1-x2).*((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2)-(x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2)+2.*y1.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8+((x2-x3).*((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2)-(x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2)+2.*y2.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8-((y1-y2).*((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2)-(y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2)+2.*x1.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8-((y2-y3).*((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2)-(y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2)+2.*x2.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8))./((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)).^2,-(((2.*x1.*(y1-y2)-2.*x3.*(y1-y2)).*(y1-y2))./8+((2.*x2.*(y1-y2)-2.*x3.*(y1-y2)).*(y2-y3))./8+((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2))./8-((x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2))./8-((x1-x2).*(2.*x3.*(x1-x2)+2.*y1.*(y1-y2)-x1.^2+x2.^2-y1.^2+y2.^2))./8-((x2-x3).*(2.*x3.*(x1-x2)+2.*y2.*(y1-y2)-x1.^2+x2.^2-y1.^2+y2.^2))./8+(y2.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)))./4)./((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))-((y1-y2).*(((x1-x2).*((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2)-(x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2)+2.*y1.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8+((x2-x3).*((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2)-(x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2)+2.*y2.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8-((y1-y2).*((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2)-(y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2)+2.*x1.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8-((y2-y3).*((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2)-(y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2)+2.*x2.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8))./((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)).^2,(((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2))./8-((2.*y2.*(x1-x2)-2.*y3.*(x1-x2)).*(x2-x3))./8-((y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2))./8-((2.*y1.*(x1-x2)-2.*y3.*(x1-x2)).*(x1-x2))./8+((y1-y2).*(2.*x1.*(x1-x2)+2.*y3.*(y1-y2)-x1.^2+x2.^2-y1.^2+y2.^2))./8+((y2-y3).*(2.*x2.*(x1-x2)+2.*y3.*(y1-y2)-x1.^2+x2.^2-y1.^2+y2.^2))./8+(x2.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)))./4)./((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))+((x1-x2).*(((x1-x2).*((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2)-(x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2)+2.*y1.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8+((x2-x3).*((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2)-(x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2)+2.*y2.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8-((y1-y2).*((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2)-(y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2)+2.*x1.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8-((y2-y3).*((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2)-(y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2)+2.*x2.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8))./((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)).^2;
        ((y2-y3).*(((x1-x3).*((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2)-(x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2)+2.*y3.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8-((x2-x3).*((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2)-(x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2)+2.*y2.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8-((y1-y3).*((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2)-(y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2)+2.*x3.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8+((y2-y3).*((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2)-(y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2)+2.*x2.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8))./((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)).^2-(((y2-y3).*(2.*x1.*(y1-y2)-2.*x1.*(y1-y3)+2.*x2.*(y2-y3)))./8-((y1-y3).*(2.*x1.*(y1-y2)-2.*x1.*(y1-y3)+2.*x3.*(y2-y3)))./8+((x1-x3).*(2.*x1.*(x1-x3)-2.*x1.*(x1-x2)+2.*y3.*(y2-y3)-x2.^2+x3.^2-y2.^2+y3.^2))./8-((x2-x3).*(2.*x1.*(x1-x3)-2.*x1.*(x1-x2)+2.*y2.*(y2-y3)-x2.^2+x3.^2-y2.^2+y3.^2))./8+((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2))./8-((x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2))./8+(y3.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)))./4)./((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)),(((x1-x3).*(2.*y1.*(x1-x2)-2.*y1.*(x1-x3)+2.*y3.*(x2-x3)))./8-((x2-x3).*(2.*y1.*(x1-x2)-2.*y1.*(x1-x3)+2.*y2.*(x2-x3)))./8-((y1-y3).*(2.*x3.*(x2-x3)-2.*y1.*(y1-y2)+2.*y1.*(y1-y3)-x2.^2+x3.^2-y2.^2+y3.^2))./8+((y2-y3).*(2.*x2.*(x2-x3)-2.*y1.*(y1-y2)+2.*y1.*(y1-y3)-x2.^2+x3.^2-y2.^2+y3.^2))./8-((y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2))./8+((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2))./8+(x3.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)))./4)./((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))-((x2-x3).*(((x1-x3).*((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2)-(x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2)+2.*y3.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8-((x2-x3).*((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2)-(x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2)+2.*y2.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8-((y1-y3).*((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2)-(y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2)+2.*x3.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8+((y2-y3).*((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2)-(y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2)+2.*x2.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8))./((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)).^2,(((2.*x2.*(y1-y3)-2.*x3.*(y1-y3)).*(y1-y3))./8+((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2))./8-((x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2))./8+((x1-x3).*(2.*x2.*(x1-x3)+2.*y3.*(y1-y3)-x1.^2+x3.^2-y1.^2+y3.^2))./8-((x2-x3).*(2.*x2.*(x1-x3)+2.*y2.*(y1-y3)-x1.^2+x3.^2-y1.^2+y3.^2))./8+(y2.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)))./4-((y2-y3).*(2.*(x1-x2).*(y1-y3)-2.*(x1-x3).*(y1-y2)))./8)./((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))-((y1-y3).*(((x1-x3).*((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2)-(x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2)+2.*y3.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8-((x2-x3).*((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2)-(x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2)+2.*y2.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8-((y1-y3).*((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2)-(y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2)+2.*x3.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8+((y2-y3).*((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2)-(y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2)+2.*x2.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8))./((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)).^2,(((2.*y2.*(x1-x3)-2.*y3.*(x1-x3)).*(x1-x3))./8+((y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2))./8-((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2))./8+((y1-y3).*(2.*x3.*(x1-x3)+2.*y2.*(y1-y3)-x1.^2+x3.^2-y1.^2+y3.^2))./8-((y2-y3).*(2.*x2.*(x1-x3)+2.*y2.*(y1-y3)-x1.^2+x3.^2-y1.^2+y3.^2))./8-(x2.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)))./4+((x2-x3).*(2.*(x1-x2).*(y1-y3)-2.*(x1-x3).*(y1-y2)))./8)./((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))+((x1-x3).*(((x1-x3).*((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2)-(x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2)+2.*y3.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8-((x2-x3).*((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2)-(x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2)+2.*y2.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8-((y1-y3).*((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2)-(y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2)+2.*x3.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8+((y2-y3).*((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2)-(y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2)+2.*x2.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8))./((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)).^2,((y1-y2).*(((x1-x3).*((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2)-(x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2)+2.*y3.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8-((x2-x3).*((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2)-(x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2)+2.*y2.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8-((y1-y3).*((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2)-(y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2)+2.*x3.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8+((y2-y3).*((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2)-(y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2)+2.*x2.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8))./((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)).^2-(((2.*x2.*(y1-y2)-2.*x3.*(y1-y2)).*(y2-y3))./8+((x1-x3).*(2.*x3.*(x1-x2)+2.*y3.*(y1-y2)-x1.^2+x2.^2-y1.^2+y2.^2))./8-((x2-x3).*(2.*x3.*(x1-x2)+2.*y2.*(y1-y2)-x1.^2+x2.^2-y1.^2+y2.^2))./8+(y2.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)))./4-(y3.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)))./4-((y1-y3).*(2.*(x1-x2).*(y1-y3)-2.*(x1-x3).*(y1-y2)))./8)./((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)),-(((2.*y2.*(x1-x2)-2.*y3.*(x1-x2)).*(x2-x3))./8+((y1-y3).*(2.*x3.*(x1-x2)+2.*y3.*(y1-y2)-x1.^2+x2.^2-y1.^2+y2.^2))./8-((y2-y3).*(2.*x2.*(x1-x2)+2.*y3.*(y1-y2)-x1.^2+x2.^2-y1.^2+y2.^2))./8-(x2.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)))./4+(x3.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)))./4+((x1-x3).*(2.*(x1-x2).*(y1-y3)-2.*(x1-x3).*(y1-y2)))./8)./((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))-((x1-x2).*(((x1-x3).*((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2)-(x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2)+2.*y3.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8-((x2-x3).*((x1-x3).*(x1.^2-x2.^2+y1.^2-y2.^2)-(x1-x2).*(x1.^2-x3.^2+y1.^2-y3.^2)+2.*y2.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8-((y1-y3).*((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2)-(y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2)+2.*x3.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8+((y2-y3).*((y1-y2).*(x1.^2-x3.^2+y1.^2-y3.^2)-(y1-y3).*(x1.^2-x2.^2+y1.^2-y2.^2)+2.*x2.*((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2))))./8))./((x1-x2).*(y1-y3)-(x1-x3).*(y1-y2)).^2];
end
end



function [out] = ObtuseTrig(M,angles,varargin)
f = ObtuseFactor(M);
A = Atot(M);
if nargin <3
    out = zeros(3,1);
    AO = f*A;
    AT = A;
else 
    out = zeros(3,6);
    dF = ObtuseFactor(M,'diff');
    dA = Atot(M,'diff');
    AO = kron(dF,A)+kron(f,dA);
    AT = dA;
end
ind = (1:3);
k1= ind(angles<pi/2); k2=ind(angles>=pi/2);
out(k1(1),:)=AO(k1(1),:); 
out(k1(2),:)=AO(k1(2),:);
out(k2(1),:)=AT-AO(k1(1),:)-AO(k1(2),:);
end



function [out] = ObtuseFactor(M,varargin)
x1=M(1); y1=M(2); x2=M(3); y2=M(4); x3=M(5); y3=M(6);
if nargin <2
  out=[ -(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./100)+((x1-x3).^2+(y1-y3).^2).^(1./2)).^2./(2.*((x2-x3).^2+(y2-y3).^2-(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./100)+((x1-x3).^2+(y1-y3).^2).^(1./2)).^2-(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./50)));
        -(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)).^2./(2.*((x1-x3).^2+(y1-y3).^2-(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)).^2-(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./50)));
        -(((x1-x3).^2+(y1-y3).^2).^(1./2)-(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)).^2./(2.*((x1-x2).^2+(y1-y2).^2-(((x1-x3).^2+(y1-y3).^2).^(1./2)-(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)).^2-(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./50)))];
else 
    
   out=[-((4.*((2.*x1-2.*x2)./(2.*((x1-x2).^2+(y1-y2).^2).^(1./2))+(2.*x1-2.*x3)./(2.*((x1-x3).^2+(y1-y3).^2).^(1./2))-(50.*(2.*x1-2.*x2).*((x1-x2).^2+(y1-y2).^2).^49+50.*(2.*x1-2.*x3).*((x1-x3).^2+(y1-y3).^2).^49)./(100.*(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(99./100))).*(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./100)+((x1-x3).^2+(y1-y3).^2).^(1./2))+(50.*(2.*x1-2.*x2).*((x1-x2).^2+(y1-y2).^2).^49+50.*(2.*x1-2.*x3).*((x1-x3).^2+(y1-y3).^2).^49)./(25.*(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(49./50))).*(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./100)+((x1-x3).^2+(y1-y3).^2).^(1./2)).^2)./(2.*(x2-x3).^2+2.*(y2-y3).^2-2.*(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./100)+((x1-x3).^2+(y1-y3).^2).^(1./2)).^2-2.*(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./50)).^2-(2.*((2.*x1-2.*x2)./(2.*((x1-x2).^2+(y1-y2).^2).^(1./2))+(2.*x1-2.*x3)./(2.*((x1-x3).^2+(y1-y3).^2).^(1./2))-(50.*(2.*x1-2.*x2).*((x1-x2).^2+(y1-y2).^2).^49+50.*(2.*x1-2.*x3).*((x1-x3).^2+(y1-y3).^2).^49)./(100.*(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(99./100))).*(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./100)+((x1-x3).^2+(y1-y3).^2).^(1./2)))./(2.*(x2-x3).^2+2.*(y2-y3).^2-2.*(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./100)+((x1-x3).^2+(y1-y3).^2).^(1./2)).^2-2.*(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./50)),-((4.*((2.*y1-2.*y2)./(2.*((x1-x2).^2+(y1-y2).^2).^(1./2))+(2.*y1-2.*y3)./(2.*((x1-x3).^2+(y1-y3).^2).^(1./2))-(50.*(2.*y1-2.*y2).*((x1-x2).^2+(y1-y2).^2).^49+50.*(2.*y1-2.*y3).*((x1-x3).^2+(y1-y3).^2).^49)./(100.*(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(99./100))).*(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./100)+((x1-x3).^2+(y1-y3).^2).^(1./2))+(50.*(2.*y1-2.*y2).*((x1-x2).^2+(y1-y2).^2).^49+50.*(2.*y1-2.*y3).*((x1-x3).^2+(y1-y3).^2).^49)./(25.*(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(49./50))).*(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./100)+((x1-x3).^2+(y1-y3).^2).^(1./2)).^2)./(2.*(x2-x3).^2+2.*(y2-y3).^2-2.*(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./100)+((x1-x3).^2+(y1-y3).^2).^(1./2)).^2-2.*(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./50)).^2-(2.*((2.*y1-2.*y2)./(2.*((x1-x2).^2+(y1-y2).^2).^(1./2))+(2.*y1-2.*y3)./(2.*((x1-x3).^2+(y1-y3).^2).^(1./2))-(50.*(2.*y1-2.*y2).*((x1-x2).^2+(y1-y2).^2).^49+50.*(2.*y1-2.*y3).*((x1-x3).^2+(y1-y3).^2).^49)./(100.*(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(99./100))).*(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./100)+((x1-x3).^2+(y1-y3).^2).^(1./2)))./(2.*(x2-x3).^2+2.*(y2-y3).^2-2.*(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./100)+((x1-x3).^2+(y1-y3).^2).^(1./2)).^2-2.*(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./50)),((((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./100)+((x1-x3).^2+(y1-y3).^2).^(1./2)).^2.*(4.*x2-4.*x3+4.*((x1-x2)./((x1-x2).^2+(y1-y2).^2).^(1./2)-((2.*x1-2.*x2).*(x1.^2-2.*x1.*x2+x2.^2+y1.^2-2.*y1.*y2+y2.^2).^49)./(2.*(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(99./100))).*(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./100)+((x1-x3).^2+(y1-y3).^2).^(1./2))+(2.*(2.*x1-2.*x2).*(x1.^2-2.*x1.*x2+x2.^2+y1.^2-2.*y1.*y2+y2.^2).^49)./(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(49./50)))./(4.*((x2-x3).^2+(y2-y3).^2-(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./100)+((x1-x3).^2+(y1-y3).^2).^(1./2)).^2-(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./50)).^2)+(((x1-x2)./((x1-x2).^2+(y1-y2).^2).^(1./2)-((2.*x1-2.*x2).*(x1.^2-2.*x1.*x2+x2.^2+y1.^2-2.*y1.*y2+y2.^2).^49)./(2.*(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(99./100))).*(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./100)+((x1-x3).^2+(y1-y3).^2).^(1./2)))./((x2-x3).^2+(y2-y3).^2-(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./100)+((x1-x3).^2+(y1-y3).^2).^(1./2)).^2-(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./50)),((((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./100)+((x1-x3).^2+(y1-y3).^2).^(1./2)).^2.*(4.*y2-4.*y3+4.*((y1-y2)./((x1-x2).^2+(y1-y2).^2).^(1./2)-((2.*y1-2.*y2).*(x1.^2-2.*x1.*x2+x2.^2+y1.^2-2.*y1.*y2+y2.^2).^49)./(2.*(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(99./100))).*(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./100)+((x1-x3).^2+(y1-y3).^2).^(1./2))+(2.*(2.*y1-2.*y2).*(x1.^2-2.*x1.*x2+x2.^2+y1.^2-2.*y1.*y2+y2.^2).^49)./(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(49./50)))./(4.*((x2-x3).^2+(y2-y3).^2-(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./100)+((x1-x3).^2+(y1-y3).^2).^(1./2)).^2-(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./50)).^2)+(((y1-y2)./((x1-x2).^2+(y1-y2).^2).^(1./2)-((2.*y1-2.*y2).*(x1.^2-2.*x1.*x2+x2.^2+y1.^2-2.*y1.*y2+y2.^2).^49)./(2.*(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(99./100))).*(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./100)+((x1-x3).^2+(y1-y3).^2).^(1./2)))./((x2-x3).^2+(y2-y3).^2-(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./100)+((x1-x3).^2+(y1-y3).^2).^(1./2)).^2-(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./50)),((((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./100)+((x1-x3).^2+(y1-y3).^2).^(1./2)).^2.*(4.*x3-4.*x2+4.*((x1-x3)./((x1-x3).^2+(y1-y3).^2).^(1./2)-((2.*x1-2.*x3).*(x1.^2-2.*x1.*x3+x3.^2+y1.^2-2.*y1.*y3+y3.^2).^49)./(2.*(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(99./100))).*(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./100)+((x1-x3).^2+(y1-y3).^2).^(1./2))+(2.*(2.*x1-2.*x3).*(x1.^2-2.*x1.*x3+x3.^2+y1.^2-2.*y1.*y3+y3.^2).^49)./(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(49./50)))./(4.*((x2-x3).^2+(y2-y3).^2-(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./100)+((x1-x3).^2+(y1-y3).^2).^(1./2)).^2-(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./50)).^2)+(((x1-x3)./((x1-x3).^2+(y1-y3).^2).^(1./2)-((2.*x1-2.*x3).*(x1.^2-2.*x1.*x3+x3.^2+y1.^2-2.*y1.*y3+y3.^2).^49)./(2.*(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(99./100))).*(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./100)+((x1-x3).^2+(y1-y3).^2).^(1./2)))./((x2-x3).^2+(y2-y3).^2-(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./100)+((x1-x3).^2+(y1-y3).^2).^(1./2)).^2-(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./50)),((((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./100)+((x1-x3).^2+(y1-y3).^2).^(1./2)).^2.*(4.*y3-4.*y2+4.*((y1-y3)./((x1-x3).^2+(y1-y3).^2).^(1./2)-((2.*y1-2.*y3).*(x1.^2-2.*x1.*x3+x3.^2+y1.^2-2.*y1.*y3+y3.^2).^49)./(2.*(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(99./100))).*(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./100)+((x1-x3).^2+(y1-y3).^2).^(1./2))+(2.*(2.*y1-2.*y3).*(x1.^2-2.*x1.*x3+x3.^2+y1.^2-2.*y1.*y3+y3.^2).^49)./(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(49./50)))./(4.*((x2-x3).^2+(y2-y3).^2-(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./100)+((x1-x3).^2+(y1-y3).^2).^(1./2)).^2-(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./50)).^2)+(((y1-y3)./((x1-x3).^2+(y1-y3).^2).^(1./2)-((2.*y1-2.*y3).*(x1.^2-2.*x1.*x3+x3.^2+y1.^2-2.*y1.*y3+y3.^2).^49)./(2.*(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(99./100))).*(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./100)+((x1-x3).^2+(y1-y3).^2).^(1./2)))./((x2-x3).^2+(y2-y3).^2-(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./100)+((x1-x3).^2+(y1-y3).^2).^(1./2)).^2-(((x1-x2).^2+(y1-y2).^2).^50+((x1-x3).^2+(y1-y3).^2).^50).^(1./50));
        -((((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)).^2.*(4.*x3-4.*x1+4.*((x1-x2)./((x1-x2).^2+(y1-y2).^2).^(1./2)-((2.*x1-2.*x2).*(x1.^2-2.*x1.*x2+x2.^2+y1.^2-2.*y1.*y2+y2.^2).^49)./(2.*(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(99./100))).*(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2))+(2.*(2.*x1-2.*x2).*(x1.^2-2.*x1.*x2+x2.^2+y1.^2-2.*y1.*y2+y2.^2).^49)./(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(49./50)))./(4.*((x1-x3).^2+(y1-y3).^2-(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)).^2-(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./50)).^2)-(((x1-x2)./((x1-x2).^2+(y1-y2).^2).^(1./2)-((2.*x1-2.*x2).*(x1.^2-2.*x1.*x2+x2.^2+y1.^2-2.*y1.*y2+y2.^2).^49)./(2.*(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(99./100))).*(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)))./((x1-x3).^2+(y1-y3).^2-(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)).^2-(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./50)),-((((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)).^2.*(4.*y3-4.*y1+4.*((y1-y2)./((x1-x2).^2+(y1-y2).^2).^(1./2)-((2.*y1-2.*y2).*(x1.^2-2.*x1.*x2+x2.^2+y1.^2-2.*y1.*y2+y2.^2).^49)./(2.*(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(99./100))).*(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2))+(2.*(2.*y1-2.*y2).*(x1.^2-2.*x1.*x2+x2.^2+y1.^2-2.*y1.*y2+y2.^2).^49)./(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(49./50)))./(4.*((x1-x3).^2+(y1-y3).^2-(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)).^2-(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./50)).^2)-(((y1-y2)./((x1-x2).^2+(y1-y2).^2).^(1./2)-((2.*y1-2.*y2).*(x1.^2-2.*x1.*x2+x2.^2+y1.^2-2.*y1.*y2+y2.^2).^49)./(2.*(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(99./100))).*(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)))./((x1-x3).^2+(y1-y3).^2-(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)).^2-(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./50)),-((4.*((2.*x2-2.*x3)./(2.*((x2-x3).^2+(y2-y3).^2).^(1./2))-(2.*x1-2.*x2)./(2.*((x1-x2).^2+(y1-y2).^2).^(1./2))+(50.*(2.*x1-2.*x2).*((x1-x2).^2+(y1-y2).^2).^49-50.*(2.*x2-2.*x3).*((x2-x3).^2+(y2-y3).^2).^49)./(100.*(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(99./100))).*(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2))-(50.*(2.*x1-2.*x2).*((x1-x2).^2+(y1-y2).^2).^49-50.*(2.*x2-2.*x3).*((x2-x3).^2+(y2-y3).^2).^49)./(25.*(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(49./50))).*(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)).^2)./(2.*(x1-x3).^2+2.*(y1-y3).^2-2.*(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)).^2-2.*(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./50)).^2-(2.*((2.*x2-2.*x3)./(2.*((x2-x3).^2+(y2-y3).^2).^(1./2))-(2.*x1-2.*x2)./(2.*((x1-x2).^2+(y1-y2).^2).^(1./2))+(50.*(2.*x1-2.*x2).*((x1-x2).^2+(y1-y2).^2).^49-50.*(2.*x2-2.*x3).*((x2-x3).^2+(y2-y3).^2).^49)./(100.*(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(99./100))).*(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)))./(2.*(x1-x3).^2+2.*(y1-y3).^2-2.*(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)).^2-2.*(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./50)),-((4.*((2.*y2-2.*y3)./(2.*((x2-x3).^2+(y2-y3).^2).^(1./2))-(2.*y1-2.*y2)./(2.*((x1-x2).^2+(y1-y2).^2).^(1./2))+(50.*(2.*y1-2.*y2).*((x1-x2).^2+(y1-y2).^2).^49-50.*(2.*y2-2.*y3).*((x2-x3).^2+(y2-y3).^2).^49)./(100.*(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(99./100))).*(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2))-(50.*(2.*y1-2.*y2).*((x1-x2).^2+(y1-y2).^2).^49-50.*(2.*y2-2.*y3).*((x2-x3).^2+(y2-y3).^2).^49)./(25.*(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(49./50))).*(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)).^2)./(2.*(x1-x3).^2+2.*(y1-y3).^2-2.*(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)).^2-2.*(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./50)).^2-(2.*((2.*y2-2.*y3)./(2.*((x2-x3).^2+(y2-y3).^2).^(1./2))-(2.*y1-2.*y2)./(2.*((x1-x2).^2+(y1-y2).^2).^(1./2))+(50.*(2.*y1-2.*y2).*((x1-x2).^2+(y1-y2).^2).^49-50.*(2.*y2-2.*y3).*((x2-x3).^2+(y2-y3).^2).^49)./(100.*(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(99./100))).*(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)))./(2.*(x1-x3).^2+2.*(y1-y3).^2-2.*(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)).^2-2.*(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./50)),((((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)).^2.*(4.*x3-4.*x1+4.*((x2-x3)./((x2-x3).^2+(y2-y3).^2).^(1./2)-((2.*x2-2.*x3).*(x2.^2-2.*x2.*x3+x3.^2+y2.^2-2.*y2.*y3+y3.^2).^49)./(2.*(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(99./100))).*(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2))+(2.*(2.*x2-2.*x3).*(x2.^2-2.*x2.*x3+x3.^2+y2.^2-2.*y2.*y3+y3.^2).^49)./(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(49./50)))./(4.*((x1-x3).^2+(y1-y3).^2-(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)).^2-(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./50)).^2)+(((x2-x3)./((x2-x3).^2+(y2-y3).^2).^(1./2)-((2.*x2-2.*x3).*(x2.^2-2.*x2.*x3+x3.^2+y2.^2-2.*y2.*y3+y3.^2).^49)./(2.*(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(99./100))).*(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)))./((x1-x3).^2+(y1-y3).^2-(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)).^2-(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./50)),((((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)).^2.*(4.*y3-4.*y1+4.*((y2-y3)./((x2-x3).^2+(y2-y3).^2).^(1./2)-((2.*y2-2.*y3).*(x2.^2-2.*x2.*x3+x3.^2+y2.^2-2.*y2.*y3+y3.^2).^49)./(2.*(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(99./100))).*(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2))+(2.*(2.*y2-2.*y3).*(x2.^2-2.*x2.*x3+x3.^2+y2.^2-2.*y2.*y3+y3.^2).^49)./(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(49./50)))./(4.*((x1-x3).^2+(y1-y3).^2-(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)).^2-(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./50)).^2)+(((y2-y3)./((x2-x3).^2+(y2-y3).^2).^(1./2)-((2.*y2-2.*y3).*(x2.^2-2.*x2.*x3+x3.^2+y2.^2-2.*y2.*y3+y3.^2).^49)./(2.*(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(99./100))).*(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)))./((x1-x3).^2+(y1-y3).^2-(((x1-x2).^2+(y1-y2).^2).^(1./2)-(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)).^2-(((x1-x2).^2+(y1-y2).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./50));
        -((((x1-x3).^2+(y1-y3).^2).^(1./2)-(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)).^2.*(4.*x2-4.*x1+4.*((x1-x3)./((x1-x3).^2+(y1-y3).^2).^(1./2)-((2.*x1-2.*x3).*(x1.^2-2.*x1.*x3+x3.^2+y1.^2-2.*y1.*y3+y3.^2).^49)./(2.*(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(99./100))).*(((x1-x3).^2+(y1-y3).^2).^(1./2)-(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2))+(2.*(2.*x1-2.*x3).*(x1.^2-2.*x1.*x3+x3.^2+y1.^2-2.*y1.*y3+y3.^2).^49)./(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(49./50)))./(4.*((x1-x2).^2+(y1-y2).^2-(((x1-x3).^2+(y1-y3).^2).^(1./2)-(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)).^2-(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./50)).^2)-(((x1-x3)./((x1-x3).^2+(y1-y3).^2).^(1./2)-((2.*x1-2.*x3).*(x1.^2-2.*x1.*x3+x3.^2+y1.^2-2.*y1.*y3+y3.^2).^49)./(2.*(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(99./100))).*(((x1-x3).^2+(y1-y3).^2).^(1./2)-(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)))./((x1-x2).^2+(y1-y2).^2-(((x1-x3).^2+(y1-y3).^2).^(1./2)-(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)).^2-(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./50)),-((((x1-x3).^2+(y1-y3).^2).^(1./2)-(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)).^2.*(4.*y2-4.*y1+4.*((y1-y3)./((x1-x3).^2+(y1-y3).^2).^(1./2)-((2.*y1-2.*y3).*(x1.^2-2.*x1.*x3+x3.^2+y1.^2-2.*y1.*y3+y3.^2).^49)./(2.*(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(99./100))).*(((x1-x3).^2+(y1-y3).^2).^(1./2)-(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2))+(2.*(2.*y1-2.*y3).*(x1.^2-2.*x1.*x3+x3.^2+y1.^2-2.*y1.*y3+y3.^2).^49)./(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(49./50)))./(4.*((x1-x2).^2+(y1-y2).^2-(((x1-x3).^2+(y1-y3).^2).^(1./2)-(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)).^2-(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./50)).^2)-(((y1-y3)./((x1-x3).^2+(y1-y3).^2).^(1./2)-((2.*y1-2.*y3).*(x1.^2-2.*x1.*x3+x3.^2+y1.^2-2.*y1.*y3+y3.^2).^49)./(2.*(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(99./100))).*(((x1-x3).^2+(y1-y3).^2).^(1./2)-(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)))./((x1-x2).^2+(y1-y2).^2-(((x1-x3).^2+(y1-y3).^2).^(1./2)-(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)).^2-(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./50)),-((((x1-x3).^2+(y1-y3).^2).^(1./2)-(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)).^2.*(4.*x1-4.*x2+4.*((x2-x3)./((x2-x3).^2+(y2-y3).^2).^(1./2)-((2.*x2-2.*x3).*(x2.^2-2.*x2.*x3+x3.^2+y2.^2-2.*y2.*y3+y3.^2).^49)./(2.*(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(99./100))).*(((x1-x3).^2+(y1-y3).^2).^(1./2)-(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2))+(2.*(2.*x2-2.*x3).*(x2.^2-2.*x2.*x3+x3.^2+y2.^2-2.*y2.*y3+y3.^2).^49)./(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(49./50)))./(4.*((x1-x2).^2+(y1-y2).^2-(((x1-x3).^2+(y1-y3).^2).^(1./2)-(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)).^2-(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./50)).^2)-(((x2-x3)./((x2-x3).^2+(y2-y3).^2).^(1./2)-((2.*x2-2.*x3).*(x2.^2-2.*x2.*x3+x3.^2+y2.^2-2.*y2.*y3+y3.^2).^49)./(2.*(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(99./100))).*(((x1-x3).^2+(y1-y3).^2).^(1./2)-(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)))./((x1-x2).^2+(y1-y2).^2-(((x1-x3).^2+(y1-y3).^2).^(1./2)-(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)).^2-(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./50)),-((((x1-x3).^2+(y1-y3).^2).^(1./2)-(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)).^2.*(4.*y1-4.*y2+4.*((y2-y3)./((x2-x3).^2+(y2-y3).^2).^(1./2)-((2.*y2-2.*y3).*(x2.^2-2.*x2.*x3+x3.^2+y2.^2-2.*y2.*y3+y3.^2).^49)./(2.*(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(99./100))).*(((x1-x3).^2+(y1-y3).^2).^(1./2)-(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2))+(2.*(2.*y2-2.*y3).*(x2.^2-2.*x2.*x3+x3.^2+y2.^2-2.*y2.*y3+y3.^2).^49)./(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(49./50)))./(4.*((x1-x2).^2+(y1-y2).^2-(((x1-x3).^2+(y1-y3).^2).^(1./2)-(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)).^2-(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./50)).^2)-(((y2-y3)./((x2-x3).^2+(y2-y3).^2).^(1./2)-((2.*y2-2.*y3).*(x2.^2-2.*x2.*x3+x3.^2+y2.^2-2.*y2.*y3+y3.^2).^49)./(2.*(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(99./100))).*(((x1-x3).^2+(y1-y3).^2).^(1./2)-(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)))./((x1-x2).^2+(y1-y2).^2-(((x1-x3).^2+(y1-y3).^2).^(1./2)-(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)).^2-(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./50)),((4.*((2.*x1-2.*x3)./(2.*((x1-x3).^2+(y1-y3).^2).^(1./2))+(2.*x2-2.*x3)./(2.*((x2-x3).^2+(y2-y3).^2).^(1./2))-(50.*(2.*x1-2.*x3).*((x1-x3).^2+(y1-y3).^2).^49+50.*(2.*x2-2.*x3).*((x2-x3).^2+(y2-y3).^2).^49)./(100.*(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(99./100))).*(((x1-x3).^2+(y1-y3).^2).^(1./2)-(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2))+(50.*(2.*x1-2.*x3).*((x1-x3).^2+(y1-y3).^2).^49+50.*(2.*x2-2.*x3).*((x2-x3).^2+(y2-y3).^2).^49)./(25.*(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(49./50))).*(((x1-x3).^2+(y1-y3).^2).^(1./2)-(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)).^2)./(2.*(x1-x2).^2+2.*(y1-y2).^2-2.*(((x1-x3).^2+(y1-y3).^2).^(1./2)-(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)).^2-2.*(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./50)).^2+(2.*((2.*x1-2.*x3)./(2.*((x1-x3).^2+(y1-y3).^2).^(1./2))+(2.*x2-2.*x3)./(2.*((x2-x3).^2+(y2-y3).^2).^(1./2))-(50.*(2.*x1-2.*x3).*((x1-x3).^2+(y1-y3).^2).^49+50.*(2.*x2-2.*x3).*((x2-x3).^2+(y2-y3).^2).^49)./(100.*(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(99./100))).*(((x1-x3).^2+(y1-y3).^2).^(1./2)-(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)))./(2.*(x1-x2).^2+2.*(y1-y2).^2-2.*(((x1-x3).^2+(y1-y3).^2).^(1./2)-(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)).^2-2.*(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./50)),((4.*((2.*y1-2.*y3)./(2.*((x1-x3).^2+(y1-y3).^2).^(1./2))+(2.*y2-2.*y3)./(2.*((x2-x3).^2+(y2-y3).^2).^(1./2))-(50.*(2.*y1-2.*y3).*((x1-x3).^2+(y1-y3).^2).^49+50.*(2.*y2-2.*y3).*((x2-x3).^2+(y2-y3).^2).^49)./(100.*(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(99./100))).*(((x1-x3).^2+(y1-y3).^2).^(1./2)-(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2))+(50.*(2.*y1-2.*y3).*((x1-x3).^2+(y1-y3).^2).^49+50.*(2.*y2-2.*y3).*((x2-x3).^2+(y2-y3).^2).^49)./(25.*(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(49./50))).*(((x1-x3).^2+(y1-y3).^2).^(1./2)-(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)).^2)./(2.*(x1-x2).^2+2.*(y1-y2).^2-2.*(((x1-x3).^2+(y1-y3).^2).^(1./2)-(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)).^2-2.*(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./50)).^2+(2.*((2.*y1-2.*y3)./(2.*((x1-x3).^2+(y1-y3).^2).^(1./2))+(2.*y2-2.*y3)./(2.*((x2-x3).^2+(y2-y3).^2).^(1./2))-(50.*(2.*y1-2.*y3).*((x1-x3).^2+(y1-y3).^2).^49+50.*(2.*y2-2.*y3).*((x2-x3).^2+(y2-y3).^2).^49)./(100.*(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(99./100))).*(((x1-x3).^2+(y1-y3).^2).^(1./2)-(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)))./(2.*(x1-x2).^2+2.*(y1-y2).^2-2.*(((x1-x3).^2+(y1-y3).^2).^(1./2)-(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./100)+((x2-x3).^2+(y2-y3).^2).^(1./2)).^2-2.*(((x1-x3).^2+(y1-y3).^2).^50+((x2-x3).^2+(y2-y3).^2).^50).^(1./50))];

end
end

function [out] = Atot(M,varargin)
x1=M(1); y1=M(2); x2=M(3); y2=M(4); x3=M(5); y3=M(6);
if nargin <2
  out=((x1-x2).*(y1-y3))/2-((x1-x3).*(y1-y2))./2;
else 
  out=[y2/2-y3/2,x3/2-x2/2,y3/2-y1/2,x1/2-x3/2,y1/2-y2/2,x2/2-x1/2]; 
end
end